var F=Object.defineProperty;var z=(e,t,s)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var m=(e,t,s)=>(z(e,typeof t!="symbol"?t+"":t,s),s);import{d as u,o,c as r,t as w,n as I,w as G,_ as C,a,F as p,r as f,b as H,e as y,v as S,u as $,p as D,f as P,g as b}from"./index.e3deb64a.js";var i=(e=>(e.Untouched="Untouched",e.UntouchedBomb="Bomb",e.Exploded="Exploded",e.Flagged="Flagged",e.Unsure="Unsure",e.Cleared="Cleared",e))(i||{}),d=(e=>(e.New="New",e.InProgress="InProgress",e.Won="Success",e.Lost="Lost",e))(d||{}),k=(e=>(e.Hard="Hard",e.Medium="Medium",e.Easy="Easy",e))(k||{}),B=(e=>(e.Large="Large",e.Medium="Medium",e.Small="Small",e))(B||{});const V=new Map([["Large",[20,20]],["Medium",[15,15]],["Small",[10,10]]]),W=new Map([["Hard",.4],["Medium",.2],["Easy",.1]]),R={size:"Small",difficulty:"Easy"};function E(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}class N{constructor(t){m(this,"board");m(this,"height");m(this,"width");m(this,"hints");const s=V.get(t.size),n=W.get(t.difficulty);if(s==null)throw Error(`Unknown game size ${t.size}`);if(n==null)throw Error(`Unknown game difficulty ${t.difficulty}`);const l=s[0],c=s[1],g=Math.round(l*c*n);console.log(`For ${l*c} cells and ${n}, num bombs: ${g}`);const h=this.create2dArray(l,c,i.Untouched);let v=0;for(;v<g;){const M=E(1,c-1),U=E(1,l-1);h[M][U]!=i.UntouchedBomb&&(h[M][U]=i.UntouchedBomb,v++)}this.board=h,this.height=h[0].length,this.width=h.length,this.hints=this.createHints()}getAdjacentCells(t,s){let n=[[t-1,s+1],[t,s+1],[t+1,s+1],[t-1,s],[t+1,s],[t-1,s-1],[t,s-1],[t+1,s-1]];return n=n.filter(l=>{const c=l[0]>=0&&l[0]<this.width,g=l[1]>=0&&l[1]<this.height;return c&&g}),n}create2dArray(t,s,n){return Array.from({length:s},()=>Array.from({length:t},()=>n))}createHints(){const t=this.create2dArray(this.height,this.width,i.Untouched);for(let s=0;s<t.length;s++)for(let n=0;n<t[s].length;n++)t[s][n]=this.countNumBombsAround(s,n);return t}isBomb(t,s){return[i.UntouchedBomb,i.Exploded].includes(this.board[t][s])}countNumBombsAround(t,s){return this.getAdjacentCells(t,s).filter(l=>this.isBomb(l[0],l[1])).length}}const T=u({computed:{cellContent(){return this.disabled&&this.cellState==i.UntouchedBomb?"b":this.cellState==i.Flagged?"F":this.cellState==i.Unsure?"?":this.cellState==i.Cleared&&this.hint>0?this.hint:""},cellClass(){var e=[];this.disabled&&e.push("disabled");var s=new Map([[i.Untouched,"untouched"],[i.UntouchedBomb,"untouched"],[i.Exploded,"exploded"],[i.Flagged,"flagged"],[i.Unsure,"unsure"],[i.Cleared,"cleared"]]).get(this.cellState);if(s==null)throw new Error(`Uh oh, we were supposed to know what the new cell class from ${this.cellState} would be`);return e.push(s),e}},methods:{emitClick(e){this.$emit("clicked",{loc:this.loc,isRightClick:e})}}}),Y=u({...T,__name:"MinesweeperCell",props:{loc:null,cellState:null,hint:null,disabled:{type:Boolean}},emits:["clicked"],setup(e){return(t,s)=>(o(),r("td",{class:I(["minesweeper-cell",t.cellClass]),onClick:s[0]||(s[0]=n=>t.emitClick(!1)),onContextmenu:s[1]||(s[1]=G(n=>t.emitClick(!0),["prevent"]))},w(t.cellContent),35))}});const L=C(Y,[["__scopeId","data-v-997c5b46"]]),X=["id"],j=u({components:{MinesweeperCell:L},computed:{tableClass(){return{won:this.gameStatus==d.Won,lost:this.gameStatus==d.Lost,"rotating-border":this.disabled}}},methods:{handleCellClicked(e){this.$emit("cell-clicked",e)}}}),q=u({...j,__name:"MinesweeperGrid",props:{gameBoard:null,hints:null,disabled:{type:Boolean},gameStatus:null},emits:["cell-clicked"],setup(e){return(t,s)=>(o(),r("div",{class:I(["minesweeper-grid",t.tableClass])},[a("table",null,[(o(!0),r(p,null,f(e.gameBoard.length,n=>(o(),r("tr",{key:`row-${n}`,id:`row-${n}`},[(o(!0),r(p,null,f(e.gameBoard[0].length,l=>(o(),H(L,{id:`col-${l}`,loc:[n-1,l-1],key:`col-${l}`,cellState:e.gameBoard[n-1][l-1],hint:e.hints[n-1][l-1],disabled:e.disabled,onClicked:t.handleCellClicked},null,8,["id","loc","cellState","hint","disabled","onClicked"]))),128))],8,X))),128))])],2))}});const J=C(q,[["__scopeId","data-v-0e6edec2"]]),A=e=>(D("data-v-f25df68f"),e=e(),P(),e),K={class:"settings"},O=A(()=>a("td",null,"Size",-1)),Q=["value"],Z=A(()=>a("td",null,"Difficulty",-1)),x=["value"],ee=u({data(){return{difficulty:k.Easy,size:B.Small}},computed:{settings(){return{size:this.size,difficulty:this.difficulty}}},methods:{handleNewGameClick(){this.$emit("new-game",this.settings)}}}),te=u({...ee,__name:"MinesweeperSettings",emits:["new-game"],setup(e){return(t,s)=>(o(),r("div",K,[a("table",null,[a("tr",null,[O,a("td",null,[y(a("select",{"onUpdate:modelValue":s[0]||(s[0]=n=>t.size=n)},[(o(!0),r(p,null,f($(B),n=>(o(),r("option",{key:n,value:n},w(n),9,Q))),128))],512),[[S,t.size]])]),Z,a("td",null,[y(a("select",{"onUpdate:modelValue":s[1]||(s[1]=n=>t.difficulty=n)},[(o(!0),r(p,null,f($(k),n=>(o(),r("option",{key:n,value:n},w(n),9,x))),128))],512),[[S,t.difficulty]])]),a("td",null,[a("button",{onClick:s[2]||(s[2]=(...n)=>t.handleNewGameClick&&t.handleNewGameClick(...n))},"New Game")])])])]))}});const se=C(te,[["__scopeId","data-v-f25df68f"]]),ne={class:"controller"},ie=a("div",{class:"description"},[a("p",null,[a("a",{href:"https://en.wikipedia.org/wiki/Minesweeper_(video_game)",target:"none"},"Minesweeper Wiki Page")])],-1),_=new N(R),le=u({data(){return{boardUtility:_,gameBoard:_.board,gameHints:_.hints,gameStatus:d.New}},computed:{gameDisabled(){return[d.Lost,d.Won].includes(this.gameStatus)},cells(){return this.gameBoard.reduce((e,t)=>e.concat(t),[])}},methods:{setupGame(e){let t=!0;this.gameStatus==d.InProgress&&(t=window.confirm("Are you sure you want to start a new game?")),t&&(this.boardUtility=new N(e),this.gameBoard=this.boardUtility.board,this.gameHints=this.boardUtility.hints,this.gameStatus=d.New)},handleCellClicked(e){this.gameDisabled||(e.isRightClick?this.handleRightClick(...e.loc):this.handleLeftClick(...e.loc))},handleLeftClick(e,t){const s=new Map([[i.Untouched,i.Cleared],[i.UntouchedBomb,i.Exploded]]);var n=this.gameBoard[e][t],l=s.get(n);l!=null&&(this.gameBoard[e][t]=l,this.updateGameStatus(),this.gameHints[e][t]==0&&this.boardUtility.getAdjacentCells(e,t).forEach(c=>{this.handleLeftClick(...c)}))},handleRightClick(e,t){const s=new Map([[i.Untouched,i.Flagged],[i.UntouchedBomb,i.Flagged],[i.Flagged,i.Unsure],[i.Unsure,i.Untouched]]);var n=this.gameBoard[e][t],l=s.get(n);l!=null&&(this.gameBoard[e][t]=l)},updateGameStatus(){if(this.cells.includes(i.Exploded)){this.gameStatus=d.Lost;return}this.gameStatus=d.InProgress;let e=this.cells.filter(s=>s==i.Cleared||s==i.Flagged||s==i.Unsure).length;this.cells.filter(s=>s==i.UntouchedBomb).length+e==this.cells.length&&(this.gameStatus=d.Won)}}}),ae=u({...le,__name:"MinesweeperController",setup(e){return(t,s)=>(o(),r("div",ne,[ie,b(se,{onNewGame:t.setupGame},null,8,["onNewGame"]),b(J,{"game-board":t.gameBoard,hints:t.gameHints,disabled:t.gameDisabled,"game-status":t.gameStatus,onCellClicked:t.handleCellClicked},null,8,["game-board","hints","disabled","game-status","onCellClicked"])]))}}),oe={class:"minesweeper"},ue=u({__name:"MinesweeperView",setup(e){return(t,s)=>(o(),r("main",oe,[b(ae)]))}});export{ue as default};
